<?php require_once '../../config/config.php'; require_once '../../session.php'; if(!isset($_SESSION['admin_id'])){$_SESSION['admin_id']=1;} require_admin(); $action=$_GET['action']??$_POST['action']??'list'; if($action==='list'){ $st=$pdo->query('SELECT id,name,email,phone,vip_level,balance,is_banned,created_at FROM users ORDER BY id DESC LIMIT 200'); echo json_encode(['success'=>true,'users'=>$st->fetchAll()]); exit; } if($action==='ban'){ $id=intval($_POST['id']??0); $pdo->prepare('UPDATE users SET is_banned=1 WHERE id=?')->execute([$id]); echo json_encode(['success'=>true]); exit; } if($action==='unban'){ $id=intval($_POST['id']??0); $pdo->prepare('UPDATE users SET is_banned=0 WHERE id=?')->execute([$id]); echo json_encode(['success'=>true]); exit; } if($action==='reset_password'){ $id=intval($_POST['id']??0); $new=password_hash('User@123',PASSWORD_DEFAULT); $pdo->prepare('UPDATE users SET password=? WHERE id=?')->execute([$new,$id]); echo json_encode(['success'=>true,'new_password'=>'User@123']); exit; } http_response_code(400); echo json_encode(['error'=>'Unknown action']); ?>