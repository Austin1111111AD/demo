<?php require_once '../../config/config.php'; require_once '../../session.php'; $d=json_decode(file_get_contents('php://input'),true); $email=strtolower(trim($d['email']??'')); $password=$d['password']??''; if(!$email||!$password){http_response_code(400);echo json_encode(['error'=>'Missing']);exit;} $st=$pdo->prepare('SELECT * FROM users WHERE email=?');$st->execute([$email]); $u=$st->fetch(); if(!$u||!password_verify($password,$u['password'])){http_response_code(401);echo json_encode(['error'=>'Invalid credentials']);exit;} if($u['is_banned']){http_response_code(403);echo json_encode(['error'=>'Banned']);exit;} $_SESSION['user_id']=$u['id']; echo json_encode(['success'=>true,'user'=>['id'=>$u['id'],'name'=>$u['name'],'vip_level'=>$u['vip_level'],'balance'=>$u['balance']]]); ?>