<?php require_once '../config/config.php'; require_once '../session.php'; $uid=require_user(); if($_SERVER['REQUEST_METHOD']==='POST'){ $d=json_decode(file_get_contents('php://input'),true); $amount=floatval($d['amount']??0); if($amount<=0){http_response_code(400);echo json_encode(['error'=>'Invalid amount']);exit;} $pdo->prepare('INSERT INTO deposits(user_id,amount) VALUES(?,?)')->execute([$uid,$amount]); echo json_encode(['success'=>true]); } else { $st=$pdo->prepare('SELECT * FROM deposits WHERE user_id=? ORDER BY created_at DESC');$st->execute([$uid]); echo json_encode(['success'=>true,'deposits'=>$st->fetchAll()]); } ?>